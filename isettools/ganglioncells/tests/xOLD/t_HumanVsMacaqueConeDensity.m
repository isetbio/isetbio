function t_HumanVsMacaqueConeDensity()

    nasalCentralRetina = macaqueNasalCentralRetina(); 
    nasalPeripheralRetina = macaqueNasalPeripheralRetina();
    nasalRetinaMacaque.eccMM = cat(1, nasalCentralRetina.eccMM(:), nasalPeripheralRetina.eccMM(:));
    nasalRetinaMacaque.eccDegs = RGCMosaicConstructor.helper.convert.eccentricityInMacaqueRetina('MMsToDegs', nasalRetinaMacaque.eccMM);
    nasalRetinaMacaque.conesPerMM2 = cat(1, nasalCentralRetina.conesPerMM2(:), nasalPeripheralRetina.conesPerMM2(:));

    temporalCentralRetina = macaqueTemporalCentralRetina(); 
    temporalPeripheralRetina = macaqueTemporalPeripheralRetina();
    temporalRetinaMacaque.eccMM = cat(1, temporalCentralRetina.eccMM(:), temporalPeripheralRetina.eccMM(:));
    temporalRetinaMacaque.eccDegs = RGCMosaicConstructor.helper.convert.eccentricityInMacaqueRetina('MMsToDegs', temporalRetinaMacaque.eccMM);
    temporalRetinaMacaque.conesPerMM2 = cat(1, temporalCentralRetina.conesPerMM2(:), temporalPeripheralRetina.conesPerMM2(:));


    load('coneDensityCurcio1990.mat', 'nasal', 'temporal', 'inferior', 'superior');
    nasalRetinaHuman.eccMM = nasal.eccMM;
    nasalRetinaHuman.eccDegs = RGCmodels.Watson.convert.rhoMMsToDegs(nasalRetinaHuman.eccMM );
    nasalRetinaHuman.conesPerMM2 = nasal.density;

    temporalRetinaHuman.eccMM = temporal.eccMM;
    temporalRetinaHuman.eccDegs = RGCmodels.Watson.convert.rhoMMsToDegs(temporalRetinaHuman.eccMM );
    temporalRetinaHuman.conesPerMM2 = temporal.density;


    humanDensityFaceColor = [0. 0. 0.];
    humanDensityEdgeColor = [0.0 0.0 0.0];

    macaqueDensityFaceColor = [0.25 0.8 0.25];
    macaqueDensityEdgeColor = [0.0 0.6 0.0];

    xRangeMMs = [-20 20];
    xRangeDegs = [-90 90];
    densityLimits = [0 300*1000];

    figNo = 10;
    ff = PublicationReadyPlotLib.figureComponents('1x1 double width figure');
    ff.axisFontSize = 24;
	hFig = figure(figNo); clf;
    theAxes = PublicationReadyPlotLib.generatePanelAxes(hFig,ff);
    ax = theAxes{1,1};

    p1 = scatter(ax,nasalRetinaMacaque.eccMM, nasalRetinaMacaque.conesPerMM2, (ff.markerSize*0.8)^2, ...
        'LineWidth', ff.lineWidth/2, ...
        'Marker', 's', ...
        'MarkerFaceColor', macaqueDensityFaceColor, ...
        'MarkerEdgeColor', macaqueDensityEdgeColor, ...
        'MarkerFaceAlpha', 0.5, ...
        'MarkerEdgeAlpha', 1.0);

    hold(ax, 'on');
    scatter(ax, -temporalRetinaMacaque.eccMM, temporalRetinaMacaque.conesPerMM2, (ff.markerSize*0.8)^2, ...
        'LineWidth', ff.lineWidth/2, ...
        'Marker', 's', ...
        'MarkerFaceColor', macaqueDensityFaceColor, ...
        'MarkerEdgeColor', macaqueDensityEdgeColor, ...
        'MarkerFaceAlpha', 0.5, ...
        'MarkerEdgeAlpha', 1.0);

    p2  = scatter(ax,nasalRetinaHuman.eccMM, nasalRetinaHuman.conesPerMM2, (ff.markerSize*0.8)^2, ...
        'LineWidth', ff.lineWidth/2, ...
        'Marker', 'o', ...
        'MarkerFaceColor', humanDensityFaceColor, ...
        'MarkerEdgeColor', humanDensityEdgeColor, ...
        'MarkerFaceAlpha', 0.5, ...
        'MarkerEdgeAlpha', 1.0);

    scatter(ax, -temporalRetinaHuman.eccMM, temporalRetinaHuman.conesPerMM2, (ff.markerSize*0.8)^2, ...
        'LineWidth', ff.lineWidth/2, ...
        'Marker', 'o', ...
        'MarkerFaceColor', humanDensityFaceColor, ...
        'MarkerEdgeColor', humanDensityEdgeColor, ...
        'MarkerFaceAlpha', 0.5, ...
        'MarkerEdgeAlpha', 1.0);

    legend(ax, [p1 p2], {'macaque', 'human'});

    set(ax, 'YScale', 'log', 'YLim', densityLimits, 'YTick', [1e3 1e3*3 1e4 1e4*3 1e5 1e5*3], 'YTickLabel', {'1k', '3k', '10k', '30K', '100k', '300K'});
    set(ax, 'XLim', xRangeMMs, 'XTick', [-20 -17.5 -15 -12.5 -10 -7.5 -5 -2.5 0 2.5 5 7.5 10 12.5 15 17.5 20])
    xlabel(ax,'(temporal)                          eccentricity (mm)                              (nasal)');
    ylabel('cone density (cones/mm^2)')
    grid(ax, 'on');

    % Finalize figure using the Publication-Ready format
	ff.legendBox = 'on';
    PublicationReadyPlotLib.applyFormat(ax,ff);
    %PublicationReadyPlotLib.offsetAxes(ax, ff, xLims, yLims);

    figureDir = fullfile(isetbioRootPath,'local',mfilename);
    if (~exist(figureDir,'dir'))
        mkdir(figureDir);
    end
    fprintf('Will save figures/videos into %s\n',figureDir);

    NicePlot.exportFigToPDF(fullfile(figureDir,'HumanVsMacaqueEccentricityInMMs.pdf'), hFig, 300);



    figNo = 20;
    ff = PublicationReadyPlotLib.figureComponents('1x1 double width figure');
    ff.axisFontSize = 24;
	hFig = figure(figNo); clf;
    theAxes = PublicationReadyPlotLib.generatePanelAxes(hFig,ff);
    ax = theAxes{1,1};

    p1 = scatter(ax,nasalRetinaMacaque.eccDegs, nasalRetinaMacaque.conesPerMM2, (ff.markerSize*0.8)^2, ...
        'LineWidth', ff.lineWidth/2, ...
        'Marker', 's', ...
        'MarkerFaceColor', macaqueDensityFaceColor, ...
        'MarkerEdgeColor', macaqueDensityEdgeColor, ...
        'MarkerFaceAlpha', 0.5, ...
        'MarkerEdgeAlpha', 1.0);

    hold(ax, 'on');
    scatter(ax, -temporalRetinaMacaque.eccDegs, temporalRetinaMacaque.conesPerMM2, (ff.markerSize*0.8)^2, ...
        'LineWidth', ff.lineWidth/2, ...
        'Marker', 's', ...
        'MarkerFaceColor', macaqueDensityFaceColor, ...
        'MarkerEdgeColor', macaqueDensityEdgeColor, ...
        'MarkerFaceAlpha', 0.5, ...
        'MarkerEdgeAlpha', 1.0);

    p2  = scatter(ax,nasalRetinaHuman.eccDegs, nasalRetinaHuman.conesPerMM2, (ff.markerSize*0.8)^2, ...
        'LineWidth', ff.lineWidth/2, ...
        'Marker', 'o', ...
        'MarkerFaceColor', humanDensityFaceColor, ...
        'MarkerEdgeColor', humanDensityEdgeColor, ...
        'MarkerFaceAlpha', 0.5, ...
        'MarkerEdgeAlpha', 1.0);

    scatter(ax, -temporalRetinaHuman.eccDegs, temporalRetinaHuman.conesPerMM2, (ff.markerSize*0.8)^2, ...
        'LineWidth', ff.lineWidth/2, ...
        'Marker', 'o', ...
        'MarkerFaceColor', humanDensityFaceColor, ...
        'MarkerEdgeColor', humanDensityEdgeColor, ...
        'MarkerFaceAlpha', 0.5, ...
        'MarkerEdgeAlpha', 1.0);

    legend(ax, [p1 p2], {'macaque', 'human'});

    set(ax, 'YScale', 'log', 'YLim', densityLimits, 'YTick', [1e3 1e3*3 1e4 1e4*3 1e5 1e5*3], 'YTickLabel', {'1k', '3k', '10k', '30K', '100k', '300K'});
    set(ax, 'XLim', xRangeDegs, 'XTick', -90:10:90)
    xlabel(ax,'(temporal)                          eccentricity (degs)                              (nasal)');
    ylabel('cone density (cones/mm^2)')
    grid(ax, 'on');

    % Finalize figure using the Publication-Ready format
	ff.legendBox = 'on';
    PublicationReadyPlotLib.applyFormat(ax,ff);
    %PublicationReadyPlotLib.offsetAxes(ax, ff, xLims, yLims);
    NicePlot.exportFigToPDF(fullfile(figureDir,'HumanVsMacaqueEccentricityInDegs.pdf'), hFig, 300);


end

function d = macaqueNasalPeripheralRetina()
    % Scanned from Packer et al 1989 (Fig 6)
    tmp = [...
        1.683337221951E0	2.546542210694E1
        2.139850858880E0	1.968415837684E1
        3.168627641104E0	1.390721252761E1
        4.245825290965E0	1.009240265072E1
        5.307266463247E0	8.893168051924E0
        6.278047287613E0	7.743551207037E0
        7.365365444227E0	7.248737209225E0
        8.393657411756E0	6.552270599322E0
        9.421949379286E0	5.855803989419E0
        1.047854240462E1	5.461361783876E0
        1.156343648776E1	5.368943982692E0
        1.258900137263E1	5.125173093996E0
        1.361547528506E1	4.730503631565E0
        1.467206831039E1	4.336061426022E0
        1.569823921363E1	3.991691488169E0
        1.672228905258E1	3.999418222366E0
        1.777797305036E1	3.755874590559E0
        1.883062695630E1	4.015326204537E0
        1.994836723501E1	3.470439939035E0];

    d.eccMM = tmp(:,1);
    d.conesPerMM2 = tmp(:,2)*1e3;
end

function d = macaqueTemporalPeripheralRetina()
    % Scanned from Packer et al 1989 (Fig 6)
    tmp = [...
        1.232459555849E0	2.531111467989E1; ...
        2.104762395348E0	1.550884332304E1; ...
        3.151234913930E0	1.179440523842E1; ...
        4.256733621596E0	8.281619765895E0; ...
        5.292600818731E0	6.327665041527E0; ...
        6.321801813813E0	5.480299857889E0; ...
        7.319974668432E0	4.783605991098E0; ...
        8.439229993061E0	3.987222102702E0; ...
        9.346439490581E0	3.390445514404E0; ...
        1.043406065638E1	2.845331992013E0; ...
        1.149035067253E1	2.501189311048E0; ...
        1.260627289613E1	2.258100193017E0; ...
        1.357281159192E1	1.812676692231E0; ...
        1.468752177879E1	1.770785672514E0; ...
        1.571338967284E1	1.476715259240E0];

    d.eccMM = tmp(:,1);
    d.conesPerMM2 = tmp(:,2)*1e3;
end


function d = macaqueNasalCentralRetina() 
    % Scanned from Packer et al 1989 (Fig 6)
    tmp = [ ...
        7.507507507508E-3	2.097707426866E2; ...
        6.006006006006E-2	1.212104388958E2; ...
        1.163663663664E-1	1.031924208778E2; ...
        1.726726726727E-1	9.639684774955E1; ...
        2.252252252252E-1	8.318724536159E1; ...
        3.153153153153E-1	6.718406783537E1; ...
        4.241741741742E-1	6.120694843140E1; ...
        5.292792792793E-1	5.683183183183E1; ...
        6.381381381381E-1	5.165631563427E1; ...
        7.469969969970E-1	4.648079943671E1; ...
        8.483483483483E-1	4.290608243514E1; ...
        9.384384384384E-1	4.053015941793E1; ...
        1.047297297297E0	3.495384161717E1; ...
        1.242492492492E0	3.020681001643E1];
    
    d.eccMM = tmp(:,1);
    d.conesPerMM2 = tmp(:,2)*1e3;
end


function d = macaqueTemporalCentralRetina() 
    % Scanned from Packer et al 1989 (Fig 6)
    tmp = [ ...
    1.126126126126E-2	2.093711446918E2; ...
    6.381381381381E-2	1.544781755704E2; ...
    1.201201201201E-1	1.156184741856E2; ...
    1.651651651652E-1	8.677520205576E1; ...
    2.177177177177E-1	7.356559966780E1; ...
    3.190690690691E-1	6.277645380852E1; ...
    4.279279279279E-1	5.279131837248E1; ...
    5.330330330330E-1	4.520978894726E1; ...
    6.343843843844E-1	4.083346873928E1; ...
    7.394894894895E-1	3.725995534613E1; ...
    8.445945945946E-1	3.448804515939E1; ...
    9.421921921922E-1	3.091212454940E1; ...
    1.051051051051E0	2.733981476466E1; ...
    1.234984984985E0	2.419237875150E1];
    
    d.eccMM = tmp(:,1);
    d.conesPerMM2 = tmp(:,2)*1e3;
end

