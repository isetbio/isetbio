function [stimParams, thePresentationDisplay] = setupSubspaceRFmappingExperiment(wavelengthSupport, ...
        stimSizeDegs, maxSFcyclesPerDegree)

    
    maxSFperiodDegs = 1/maxSFcyclesPerDegree;
    minSamplesPerMaxSFperiod = 2;
    pixelSizeDegs = maxSFperiodDegs/minSamplesPerMaxSFperiod;
    omega = round(maxSFcyclesPerDegree * max(stimSizeDegs));
    nStim = (2*omega+1)^2;
    stimulusPixelsNum = round(max(stimSizeDegs)/pixelSizeDegs);
    a = single(1);
    s = whos('a');
    HartleyMemoryRequirementGBytes = (nStim * stimulusPixelsNum * stimulusPixelsNum * s.bytes)/1024/1024/1024;
    fprintf('\nTo probe RFs with spatial frequencies up to %2.1f c/deg\nusing a patch size of %2.1f degs,\n%d (%d x %d) Hartley patterns (retinal res:%2.1f arc min) will be employed.\nThis requires %2.1f GBytes or RAM\n', ...
        maxSFcyclesPerDegree, stimSizeDegs(1), nStim, stimulusPixelsNum, stimulusPixelsNum, pixelSizeDegs*60, HartleyMemoryRequirementGBytes);

    % Generate a presentation display with a desired resolution
    viewingDistanceMeters = 4;

    thePresentationDisplay = rfMappingStimulusGenerator.presentationDisplay(...
            wavelengthSupport, pixelSizeDegs, ...
            viewingDistanceMeters);

    % Stim params for the RF mapping
    stimParams = struct(...
            'backgroundLuminanceCdM2', 50.0, ...
            'backgroundChromaticity', [0.301 0.301], ...
            'coneContrasts', [1 1 1], ...
            'contrast', 0.75, ...
            'omega', omega, ...
            'pixelSizeDegs', pixelSizeDegs, ...
            'stimSizeDegs', max(stimSizeDegs), ...
            'wavelengthSupport', displayGet(thePresentationDisplay, 'wave'), ...
            'viewingDistanceMeters', displayGet(thePresentationDisplay, 'viewing distance') ...
            );

end
